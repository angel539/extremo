<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.9">
<meta name="Forrest-skin-name" content="pelt">
<title>Busy Developers' Guide to HSLF drawing layer</title>
<link type="text/css" href="../../skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
<link type="text/css" href="../../skin/profile.css" rel="stylesheet">
<script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="../../images/favicon.ico">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="https://www.apache.org">Apache Software Foundation</a> &gt; <a href="https://poi.apache.org">Apache POI</a><script src="../../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="https://www.apache.org"><img class="logoImage" alt="Apache Software Foundation" src="../../images/group-logo.png" title="The Apache Software Foundation is a cornerstone of the modern Open Source software ecosystem &ndash; supporting some of the most widely used and important software solutions powering today's Internet economy."></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="https://poi.apache.org"><img class="logoImage" alt="Apache POI" src="../../images/project-header.png" title="Apache POI is well-known in the Java field as a library for reading and writing Microsoft Office file formats, such as Excel, PowerPoint, Word, Visio, Publisher and Outlook. It supports both the older (OLE2) and new (OOXML - Office Open XML) formats."></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="poi.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="../../index.html">Home</a>
</li>
<li>
<a class="unselected" href="../../help/index.html">Help</a>
</li>
<li class="current">
<a class="selected" href="../../components/index.html">Component APIs</a>
</li>
<li>
<a class="unselected" href="../../devel/index.html">Getting Involved</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', '../../skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">Component APIs</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../../components/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../apidocs/dev/index.html">Javadocs</a>
</div>
<div onclick="SwitchMenu('menu_1.1.3', '../../skin/')" id="menu_1.1.3Title" class="menutitle">Excel (HSSF/XSSF)</div>
<div id="menu_1.1.3" class="menuitemgroup">
<div class="menuitem">
<a href="../../components/spreadsheet/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/quick-guide.html">Quick Guide</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/how-to.html">HOWTO</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/converting.html">HSSF to SS Converting</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/formula.html">Formula Support</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/eval.html">Formula Evaluation</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/eval-devguide.html">Eval Dev Guide</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/examples.html">Examples</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/use-case.html">Use Case</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/diagrams.html">Pictorial Docs</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/limitations.html">Limitations</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/user-defined-functions.html">User Defined Functions</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/excelant.html">ExcelAnt Tests</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/hacking-hssf.html">Hacking HSSF</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/record-generator.html">Record Generator</a>
</div>
<div class="menuitem">
<a href="../../components/spreadsheet/chart.html">Charts</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.4', '../../skin/')" id="menu_selected_1.1.4Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">PowerPoint (HSLF/XSLF)</div>
<div id="menu_selected_1.1.4" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../../components/slideshow/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../components/slideshow/quick-guide.html">Quick Guide</a>
</div>
<div class="menupage">
<div class="menupagetitle">HSLF Cookbook</div>
</div>
<div class="menuitem">
<a href="../../components/slideshow/xslf-cookbook.html">XSLF Cookbook</a>
</div>
<div class="menuitem">
<a href="../../components/slideshow/ppt-file-format.html">PPT File Format</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.5', '../../skin/')" id="menu_1.1.5Title" class="menutitle">Word (HWPF/XWPF)</div>
<div id="menu_1.1.5" class="menuitemgroup">
<div class="menuitem">
<a href="../../components/document/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../components/document/quick-guide.html">HWPF Quick Guide</a>
</div>
<div class="menuitem">
<a href="../../components/document/quick-guide-xwpf.html">XWPF Quick Guide</a>
</div>
<div class="menuitem">
<a href="../../components/document/docoverview.html">HWPF Format</a>
</div>
<div class="menuitem">
<a href="../../components/document/projectplan.html">HWPF Project plan</a>
</div>
</div>
<div class="menuitem">
<a href="../../components/hsmf/index.html">Outlook (HSMF)</a>
</div>
<div class="menuitem">
<a href="../../components/diagram/index.html">Visio (HDGF+XDGF)</a>
</div>
<div onclick="SwitchMenu('menu_1.1.8', '../../skin/')" id="menu_1.1.8Title" class="menutitle">Publisher (HPBF)</div>
<div id="menu_1.1.8" class="menuitemgroup">
<div class="menuitem">
<a href="../../components/hpbf/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../components/hpbf/file-format.html">File Format</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.9', '../../skin/')" id="menu_1.1.9Title" class="menutitle">OLE2 Filesystem (POIFS)</div>
<div id="menu_1.1.9" class="menuitemgroup">
<div class="menuitem">
<a href="../../components/poifs/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../components/poifs/how-to.html">How To</a>
</div>
<div class="menuitem">
<a href="../../components/poifs/embeded.html">Embedded Documents</a>
</div>
<div class="menuitem">
<a href="../../components/poifs/fileformat.html">File System Documentation</a>
</div>
<div class="menuitem">
<a href="../../components/poifs/usecases.html">Use Cases</a>
</div>
<div class="menuitem">
<a href="../../components/poifs/design.html">Design</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.10', '../../skin/')" id="menu_1.1.10Title" class="menutitle">OLE2 Document Props (HPSF)</div>
<div id="menu_1.1.10" class="menuitemgroup">
<div class="menuitem">
<a href="../../components/hpsf/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../components/hpsf/how-to.html">How To</a>
</div>
<div class="menuitem">
<a href="../../components/hpsf/thumbnails.html">Thumbnails</a>
</div>
<div class="menuitem">
<a href="../../components/hpsf/internals.html">Internals</a>
</div>
<div class="menuitem">
<a href="../../components/hpsf/todo.html">To Do</a>
</div>
</div>
<div class="menuitem">
<a href="../../components/hmef/index.html">TNEF (HMEF) for winmail.dat</a>
</div>
<div class="menuitem">
<a href="../../components/oxml4j/index.html">OpenXML4J (OOXML)</a>
</div>
<div class="menuitem">
<a href="../../components/logging.html">Logging framework</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="../../skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2">
<a href="https://donate.apache.org/"><img border="0" title="Support Apache" alt="Support Apache - logo" src="../../images/support-asf.png" style="width: 125px;height: 125px;"></a><a href="https://www.apache.org/foundation/press/kit/#poweredby"><img border="0" title="powered by POI" alt="powered by POI - logo" src="../../images/poweredby-poi-logo.png" style="width: 125px;height: 125px;"></a>
</div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<h1>Busy Developers' Guide to HSLF drawing layer</h1>
<div id="front-matter"></div>
        
<a name="Busy+Developers%27+Guide+to+HSLF+drawing+layer"></a>
<h2 class="boxed">Busy Developers' Guide to HSLF drawing layer</h2>
<div class="section">
<a name="Index+of+Features"></a>
<h3 class="boxed">Index of Features</h3>
<ul>
                    
<li>
<a href="#NewPresentation">How to create a new presentation and add new slides to it</a>
</li>
                    
<li>
<a href="#PageSize">How to retrieve or change slide size</a>
</li>
                    
<li>
<a href="#GetShapes">How to get shapes contained in a particular slide</a>
</li>
                    
<li>
<a href="#Shapes">Drawing a shape on a slide</a>
</li>
                    
<li>
<a href="#Pictures">How to work with pictures</a>
</li>
                    
<li>
<a href="#SlideTitle">How to set slide title</a>
</li>
                    
<li>
<a href="#Fill">How to work with slide/shape background</a>
</li>
                    
<li>
<a href="#Bullets">How to create bulleted lists</a>
</li>
                    
<li>
<a href="#Hyperlinks">Hyperlinks</a>
</li>
                    
<li>
<a href="#Tables">Tables</a>
</li>
                    
<li>
<a href="#RemoveShape">How to remove shapes</a>
</li>
                    
<li>
<a href="#OLE">How to retrieve embedded OLE objects</a>
</li>
                    
<li>
<a href="#Sound">How to retrieve embedded sounds</a>
</li>
                    
<li>
<a href="#Freeform">How to create shapes of arbitrary geometry</a>
</li>
                    
<li>
<a href="#Graphics2D">Shapes and Graphics2D</a>
</li>
                    
<li>
<a href="#Render">How to convert slides into images</a>
</li>
                    
<li>
<a href="#HeadersFooters">Headers / Footers</a>
</li>
                
</ul>
<a name="Features"></a>
<h3 class="boxed">Features</h3>
<a name="NewPresentation" id="NewPresentation"></a><a name="New+Presentation"></a>
<h4>New Presentation</h4>
<pre class="code">
    //create a new empty slide show
    HSLFSlideShow ppt = new HSLFSlideShow();
    
    //add first slide
    HSLFSlide s1 = ppt.createSlide();
    
    //add second slide
    HSLFSlide s2 = ppt.createSlide();
    
    //save changes in a file
    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                 </pre>
<a name="PageSize" id="PageSize"></a><a name="How+to+retrieve+or+change+slide+size"></a>
<h4>How to retrieve or change slide size</h4>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow(new HSLFSlideShowImpl("slideshow.ppt"));
    //retrieve page size. Coordinates are expressed in points (72 dpi)
    java.awt.Dimension pgsize = ppt.getPageSize();
    int pgx = pgsize.width; //slide width
    int pgy = pgsize.height; //slide height

    //set new page size
    ppt.setPageSize(new java.awt.Dimension(1024, 768));
    //save changes 
    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                  </pre>
<a name="GetShapes" id="GetShapes"></a><a name="How+to+get+shapes+contained+in+a+particular+slide"></a>
<h4>How to get shapes contained in a particular slide</h4>
<p>
                    The following code demonstrates how to iterate over shapes for each slide.
                  </p>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow(new HSLFSlideShowImpl("slideshow.ppt"));
    // get slides
    for (HSLFSlide slide : ppt.getSlides()) {
        for (HSLFShape sh : slide.getShapes()) {
            // name of the shape
            String name = sh.getShapeName();

            // shapes's anchor which defines the position of this shape in the slide
            java.awt.Rectangle anchor = sh.getAnchor();

            if (sh instanceof Line) {
                Line line = (Line) sh;
                // work with Line
            } else if (sh instanceof HSLFAutoShape) {
                HSLFAutoShape shape = (HSLFAutoShape) sh;
                // work with AutoShape
            } else if (sh instanceof HSLFTextBox) {
                HSLFTextBox shape = (HSLFTextBox) sh;
                // work with TextBox
            } else if (sh instanceof HSLFPictureShape) {
                HSLFPictureShape shape = (HSLFPictureShape) sh;
                // work with Picture
            }
        }
    }
                  </pre>
<a name="Shapes" id="Shapes"></a><a name="Drawing+a+shape+on+a+slide"></a>
<h4>Drawing a shape on a slide</h4>
<div class="warning">
<div class="label">Warning</div>
<div class="content">
    To work with graphic objects HSLF uses Java2D classes
    that may throw exceptions if graphical environment is not available. In case if graphical environment
    is not available, you must tell Java that you are running in headless mode and
    set the following system property: <span class="codefrag"> java.awt.headless=true </span>
    (either via <span class="codefrag">-Djava.awt.headless=true</span> startup parameter or via <span class="codefrag">System.setProperty("java.awt.headless", "true")</span>).
        </div>
</div>
<p>
                     When you add a shape, you usually specify the dimensions of the shape and the position
                     of the upper left corner of the bounding box for the shape relative to the upper left
                     corner of the slide. Distances in the drawing layer are measured in points (72 points = 1 inch).
                   </p>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();
    
    HSLFSlide slide = ppt.createSlide();
    
    //Line shape
    Line line = new Line();
    line.setAnchor(new java.awt.Rectangle(50, 50, 100, 20));
    line.setLineColor(new Color(0, 128, 0));
    line.setLineCompound(LineCompound.DOUBLE);
    slide.addShape(line);
    
    //TextBox
    HSLFTextBox txt = new HSLFTextBox();
    txt.setText("Hello, World!");
    txt.setAnchor(new java.awt.Rectangle(300, 100, 300, 50));
    
    // use TextRun to work with the text format
    HSLFTextParagraph tp = txt.getTextParagraphs().get(0);
    tp.setAlignment(TextAlign.RIGHT);
    HSLFTextRun rt = tp.getTextRuns().get(0);
    rt.setFontSize(32.);
    rt.setFontFamily("Arial");
    rt.setBold(true);
    rt.setItalic(true);
    rt.setUnderlined(true);
    rt.setFontColor(Color.red);
    
    slide.addShape(txt);
    
    // Autoshape
    // 32-point star
    HSLFAutoShape sh1 = new HSLFAutoShape(ShapeType.STAR_32);
    sh1.setAnchor(new java.awt.Rectangle(50, 50, 100, 200));
    sh1.setFillColor(Color.red);
    slide.addShape(sh1);
    
    //Trapezoid
    HSLFAutoShape sh2 = new HSLFAutoShape(ShapeType.TRAPEZOID);
    sh2.setAnchor(new java.awt.Rectangle(150, 150, 100, 200));
    sh2.setFillColor(Color.blue);
    slide.addShape(sh2);
    
    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                  </pre>
<a name="Pictures" id="Pictures"></a><a name="How+to+work+with+pictures"></a>
<h4>How to work with pictures</h4>
<p>
  Currently, HSLF API supports the following types of pictures:
  </p>
<ul>
    
<li>Windows Metafiles (WMF)</li>
    
<li>Enhanced Metafiles (EMF)</li>
    
<li>JPEG Interchange Format</li>
    
<li>Portable Network Graphics (PNG)</li>
    
<li>Macintosh PICT</li>
  
</ul>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow(new HSLFSlideShowImpl("slideshow.ppt"));

    // extract all pictures contained in the presentation
    int idx = 1;
    for (HSLFPictureData pict : ppt.getPictureData()) {
        // picture data
        byte[] data = pict.getData();

        PictureData.PictureType type = pict.getType();
        String ext = type.extension;
        FileOutputStream out = new FileOutputStream("pict_" + idx + ext);
        out.write(data);
        out.close();
        idx++;
    }

    // add a new picture to this slideshow and insert it in a new slide
    HSLFPictureData pd = ppt.addPicture(new File("clock.jpg"), PictureData.PictureType.JPEG);

    HSLFPictureShape pictNew = new HSLFPictureShape(pd);

    // set image position in the slide
    pictNew.setAnchor(new java.awt.Rectangle(100, 100, 300, 200));

    HSLFSlide slide = ppt.createSlide();
    slide.addShape(pictNew);

    // now retrieve pictures containes in the first slide and save them on disk
    idx = 1;
    slide = ppt.getSlides().get(0);
    for (HSLFShape sh : slide.getShapes()) {
        if (sh instanceof HSLFPictureShape) {
            HSLFPictureShape pict = (HSLFPictureShape) sh;
            HSLFPictureData pictData = pict.getPictureData();
            byte[] data = pictData.getData();
            PictureData.PictureType type = pictData.getType();
            FileOutputStream out = new FileOutputStream("slide0_" + idx + type.extension);
            out.write(data);
            out.close();
            idx++;
        }
    }

    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                    </pre>
<a name="SlideTitle" id="SlideTitle"></a><a name="How+to+set+slide+title"></a>
<h4>How to set slide title</h4>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();
    HSLFSlide slide = ppt.createSlide();
    HSLFTextBox title = slide.addTitle();
    title.setText("Hello, World!");

    // save changes
    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                  </pre>
<p>
                    Below is the equivalent code in PowerPoint VBA:
                  </p>
<pre class="code">
    Set myDocument = ActivePresentation.Slides(1)
    myDocument.Shapes.AddTitle.TextFrame.TextRange.Text = "Hello, World!"
                  </pre>
<a name="Fill" id="Fill"></a><a name="How+to+modify+background+of+a+slide+master"></a>
<h4>How to modify background of a slide master</h4>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();
    HSLFSlideMaster master = ppt.getSlideMasters().get(0);

    HSLFFill fill = master.getBackground().getFill();
    HSLFPictureData pd = ppt.addPicture(new File("background.png"), PictureData.PictureType.PNG);
    fill.setFillType(HSLFFill.FILL_PICTURE);
    fill.setPictureData(pd);
                  </pre>
<a name="How+to+modify+background+of+a+slide"></a>
<h4>How to modify background of a slide</h4>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();
    HSLFSlide slide = ppt.createSlide();

    // This slide has its own background.
    // Without this line it will use master's background.
    slide.setFollowMasterBackground(false);
    HSLFFill fill = slide.getBackground().getFill();
    HSLFPictureData pd = ppt.addPicture(new File("background.png"), PictureData.PictureType.PNG);
    fill.setFillType(HSLFFill.FILL_PATTERN);
    fill.setPictureData(pd);    
                  </pre>
<a name="How+to+modify+background+of+a+shape"></a>
<h4>How to modify background of a shape</h4>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();
    HSLFSlide slide = ppt.createSlide();
    
    HSLFShape shape = new HSLFAutoShape(ShapeType.RECT);
    shape.setAnchor(new java.awt.Rectangle(100, 100, 200, 200));
    HSLFFill fill = shape.getFill();
    fill.setFillType(HSLFFill.FILL_SHADE);
    fill.setBackgroundColor(Color.red);
    fill.setForegroundColor(Color.green);
    
    slide.addShape(shape);
                  </pre>
<a name="Bullets" id="Bullets"></a><a name="How+to+create+bulleted+lists"></a>
<h4>How to create bulleted lists</h4>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();

    HSLFSlide slide = ppt.createSlide();

    HSLFTextBox shape = new HSLFTextBox();
    HSLFTextParagraph tp = shape.getTextParagraphs().get(0);
    tp.setBullet(true);
    tp.setBulletChar('\u263A'); //bullet character
    tp.setIndent(0.);  //bullet offset
    tp.setLeftMargin(50.);   //text offset (should be greater than bullet offset)
    HSLFTextRun rt = tp.getTextRuns().get(0);
    shape.setText(
        "January\r" +
        "February\r" +
        "March\r" +
        "April");
    rt.setFontSize(42.);
    slide.addShape(shape);

    shape.setAnchor(new java.awt.Rectangle(50, 50, 500, 300));  //position of the text box in the slide
    slide.addShape(shape);

    FileOutputStream out = new FileOutputStream("bullets.ppt");
    ppt.write(out);
    out.close();
                </pre>
<a name="Hyperlinks" id="Hyperlinks"></a><a name="How+to+read+hyperlinks+from+a+slide+show"></a>
<h4>How to read hyperlinks from a slide show</h4>
<pre class="code">
    FileInputStream is = new FileInputStream("slideshow.ppt");
    HSLFSlideShow ppt = new HSLFSlideShow(is);
    is.close();

    for (HSLFSlide slide : ppt.getSlides()) {
        //read hyperlinks from the text runs
        for (List&lt;HSLFTextParagraph&gt; txt : slide.getTextParagraphs()) {
            for (HSLFTextParagraph para : txt) {
                for (HSLFTextRun run : para) {
                    HSLFHyperlink link = run.getHyperlink();
                    if (link != null) {
                        String title = link.getLabel();
                        String address = link.getAddress();
                        String text = run.getRawText();
                    }
                }
            }
        }

        //in PowerPoint you can assign a hyperlink to a shape without text,
        //for example to a Line object. The code below demonstrates how to
        //read such hyperlinks
        for (HSLFShape sh : slide.getShapes()) {
            if (sh instanceof HSLFSimpleShape) {
                HSLFHyperlink link = ((HSLFSimpleShape)sh).getHyperlink();
                if(link != null)  {
                    String title = link.getLabel();
                    String address = link.getAddress();
                }
            }
        }
    }
                </pre>
<a name="Tables" id="Tables"></a><a name="How+to+create+tables"></a>
<h4>How to create tables</h4>
<pre class="code">
    //table data              
    String[][] data = {
        {"INPUT FILE", "NUMBER OF RECORDS"},
        {"Item File", "11,559"},
        {"Vendor File", "300"},
        {"Purchase History File", "10,000"},
        {"Total # of requisitions", "10,200,038"}
    };

    HSLFSlideShow ppt = new HSLFSlideShow();

    HSLFSlide slide = ppt.createSlide();
    //create a table of 5 rows and 2 columns
    HSLFTable table = new HSLFTable(5, 2);
    for (int i = 0; i &lt; data.length; i++) {
        for (int j = 0; j &lt; data[i].length; j++) {
            HSLFTableCell cell = table.getCell(i, j);
            cell.setText(data[i][j]);

            HSLFTextRun rt = cell.getTextParagraphs().get(0).getTextRuns().get(0);
            rt.setFontFamily("Arial");
            rt.setFontSize(10.);

            cell.setVerticalAlignment(VerticalAlignment.MIDDLE);
            cell.setHorizontalCentered(true);
        }
    }

    //set table borders
    Line border = table.createBorder();
    border.setLineColor(Color.black);
    border.setLineWidth(1.0);
    table.setAllBorders(border);

    //set width of the 1st column
    table.setColumnWidth(0, 300);
    //set width of the 2nd column
    table.setColumnWidth(1, 150);

    slide.addShape(table);
    table.moveTo(100, 100);

    FileOutputStream out = new FileOutputStream("hslf-table.ppt");
    ppt.write(out);
    out.close();
                    </pre>
<a name="RemoveShape" id="RemoveShape"></a><a name="How+to+remove+shapes+from+a+slide"></a>
<h4>How to remove shapes from a slide</h4>
<pre class="code">
    for (HSLFShape shape : slide.getShapes()) {
        // remove the shape
        boolean ok = slide.removeShape(shape);
        if (ok) {
            // the shape was removed. Do something.
        }
    }
                    </pre>
<a name="OLE" id="OLE"></a><a name="How+to+retrieve+embedded+OLE+objects"></a>
<h4>How to retrieve embedded OLE objects</h4>
<pre class="code">
    for (HSLFShape shape : slide.getShapes()) {
        if (shape instanceof OLEShape) {
            OLEShape ole = (OLEShape) shape;
            HSLFObjectData data = ole.getObjectData();
            String name = ole.getInstanceName();
            if ("Worksheet".equals(name)) {
                HSSFWorkbook wb = new HSSFWorkbook(data.getData());
            } else if ("Document".equals(name)) {
                HWPFDocument doc = new HWPFDocument(data.getData());
            }
        }
    }
                    </pre>
<a name="Sound" id="Sound"></a><a name="How+to+retrieve+embedded+sounds"></a>
<h4>How to retrieve embedded sounds</h4>
<pre class="code">
    FileInputStream is = new FileInputStream(args[0]);
    HSLFSlideShow ppt = new HSLFSlideShow(is);
    is.close();

    for (HSLFSoundData sound : ppt.getSoundData()) {
        // save *WAV sounds on disk
        if (sound.getSoundType().equals(".WAV")) {
            FileOutputStream out = new FileOutputStream(sound.getSoundName());
            out.write(sound.getData());
            out.close();
        }
    }
                    </pre>
<a name="Freeform" id="Freeform"></a><a name="How+to+create+shapes+of+arbitrary+geometry"></a>
<h4>How to create shapes of arbitrary geometry</h4>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();
    HSLFSlide slide = ppt.createSlide();

    java.awt.geom.GeneralPath path = new java.awt.geom.GeneralPath();
    path.moveTo(100, 100);
    path.lineTo(200, 100);
    path.curveTo(50, 45, 134, 22, 78, 133);
    path.curveTo(10, 45, 134, 56, 78, 100);
    path.lineTo(100, 200);
    path.closePath();

    HSLFFreeformShape shape = new HSLFFreeformShape();
    shape.setPath(path);
    slide.addShape(shape);
                    </pre>
<a name="Graphics2D" id="Graphics2D"></a><a name="How+to+draw+into+a+slide+using+Graphics2D"></a>
<h4>How to draw into a slide using Graphics2D</h4>
<div class="warning">
<div class="label">Warning</div>
<div class="content">
                   Current implementation of the PowerPoint Graphics2D driver is not fully compliant with the java.awt.Graphics2D specification.
                   Some features like clipping, drawing of images are not yet supported. 
                  </div>
</div>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();
    HSLFSlide slide = ppt.createSlide();

    // draw a simple bar graph
    // bar chart data.
    // The first value is the bar color,
    // the second is the width
    Object[] def = new Object[]{
        Color.yellow, new Integer(100),
        Color.green, new Integer(150),
        Color.gray, new Integer(75),
        Color.red, new Integer(200),
    };

    // all objects are drawn into a shape group so we need to create one

    HSLFGroupShape group = new HSLFGroupShape();
    // define position of the drawing in the slide
    Rectangle bounds = new java.awt.Rectangle(200, 100, 350, 300);
    // if you want to draw in the entire slide area then define the anchor
    // as follows:
    // Dimension pgsize = ppt.getPageSize();
    // java.awt.Rectangle bounds = new java.awt.Rectangle(0, 0,
    // pgsize.width, pgsize.height);

    group.setAnchor(bounds);
    slide.addShape(group);

    // draw a simple bar chart
    Graphics2D graphics = new PPGraphics2D(group);
    int x = bounds.x + 50, y = bounds.y + 50;
    graphics.setFont(new Font("Arial", Font.BOLD, 10));
    for (int i = 0, idx = 1; i &lt; def.length; i += 2, idx++) {
        graphics.setColor(Color.black);
        int width = ((Integer) def[i + 1]).intValue();
        graphics.drawString("Q" + idx, x - 20, y + 20);
        graphics.drawString(width + "%", x + width + 10, y + 20);
        graphics.setColor((Color) def[i]);
        graphics.fill(new Rectangle(x, y, width, 30));
        y += 40;
    }
    graphics.setColor(Color.black);
    graphics.setFont(new Font("Arial", Font.BOLD, 14));
    graphics.draw(bounds);
    graphics.drawString("Performance", x + 70, y + 40);

    FileOutputStream out = new FileOutputStream("hslf-graphics2d.ppt");
    ppt.write(out);
    out.close();
                   </pre>
<a name="Render" id="Render"></a><a name="Export+PowerPoint+slides+into+java.awt.Graphics2D"></a>
<h4>Export PowerPoint slides into java.awt.Graphics2D</h4>
<p>
                    HSLF provides a way to export slides into images. You can capture slides into java.awt.Graphics2D object (or any other) 
                    and serialize it into a PNG or JPEG format. Please note, although HSLF attempts to render slides as close to PowerPoint as possible, 
                    the output may look differently from PowerPoint due to the following reasons: 
                  </p>
<ul>
              
<li>Java2D renders fonts differently vs PowerPoint. There are always some differences in the way the font glyphs are painted</li>   
              
<li>HSLF uses java.awt.font.LineBreakMeasurer to break text into lines. PowerPoint may do it in a different way.</li>
              
<li>If a font from the presentation is not available, then the JDK default font will be used.</li>
            
</ul>
<p>
            Current Limitations:
            </p>
<ul>
              
<li>Some types of shapes are not yet supported (WordArt, complex auto-shapes)</li>
              
<li>Only Bitmap images (PNG, JPEG, DIB) can be rendered in Java</li>  
            
</ul>
<pre class="code">
    FileInputStream is = new FileInputStream("slideshow.ppt");
    HSLFSlideShow ppt = new HSLFSlideShow(is);
    is.close();

    Dimension pgsize = ppt.getPageSize();

    int idx = 1;
    for (HSLFSlide slide : ppt.getSlides()) {

        BufferedImage img = new BufferedImage(pgsize.width, pgsize.height, BufferedImage.TYPE_INT_RGB);
        Graphics2D graphics = img.createGraphics();
        // clear the drawing area
        graphics.setPaint(Color.white);
        graphics.fill(new Rectangle2D.Float(0, 0, pgsize.width, pgsize.height));

        // render
        slide.draw(graphics);

        // save the output
        FileOutputStream out = new FileOutputStream("slide-" + idx + ".png");
        javax.imageio.ImageIO.write(img, "png", out);
        out.close();

        idx++;
    }
                  </pre>
<a name="HeadersFooters" id="HeadersFooters"></a><a name="How+to+extract+Headers+%2F+Footers+from+an+existing+presentation"></a>
<h3 class="boxed">How to extract Headers / Footers from an existing presentation</h3>
<pre class="code">
    FileInputStream is = new FileInputStream("slideshow.ppt");
    HSLFSlideShow ppt = new HSLFSlideShow(is);
    is.close();

    // presentation-scope headers / footers
    HeadersFooters hdd = ppt.getSlideHeadersFooters();
    if (hdd.isFooterVisible()) {
        String footerText = hdd.getFooterText();
    }

    // per-slide headers / footers
    for (HSLFSlide slide : ppt.getSlides()) {
        HeadersFooters hdd2 = slide.getHeadersFooters();
        if (hdd2.isFooterVisible()) {
            String footerText = hdd2.getFooterText();
        }
        if (hdd2.isUserDateVisible()) {
            String customDate = hdd2.getDateTimeText();
        }
        if (hdd2.isSlideNumberVisible()) {
            int slideNUm = slide.getSlideNumber();
        }
    }
                </pre>
<a name="How+to+set+Headers+%2F+Footers"></a>
<h3 class="boxed">How to set Headers / Footers</h3>
<pre class="code">
    HSLFSlideShow ppt = new HSLFSlideShow();

    // presentation-scope headers / footers
    HeadersFooters hdd = ppt.getSlideHeadersFooters();
    hdd.setSlideNumberVisible(true);
    hdd.setFootersText("Created by POI-HSLF");
                </pre>
</div>
    
<p align="right">
<font size="-2">by&nbsp;Yegor Kozlov</font>
</p>
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2001-2018 <a href="https://www.apache.org/">The Apache Software Foundation</a>
</div>
<div id="feedback">
        Send feedback about the website to:
    <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/slideshow/how-to-shapes.html">dev@poi.apache.org</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
